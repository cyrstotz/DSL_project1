The equation for the ice fraction \( x_2 \) in state 2 is derived using the energy balance:  
\[
\phi = q_f + x_2 \left( q_{lg} - q_f \right)
\]  

The internal energy \( u_2 \) is calculated as:  
\[
u_2 = u_{2f} + x_2 \left( u_{2g} - u_{2f} \right)
\]  

The temperature of the ice-water mixture in state 2 is given as:  
\[
T_{\text{EW},2} = 0^\circ\text{C}
\]  

To calculate \( x_2 \), the following formula is used:  
\[
x_2 = \frac{u_2 - u_{2f}}{u_{2g} - u_{2f}}
\]  

Substituting values:  
\[
x_2 = \frac{-3047.093 - (-0.045)}{-333.458 - (-0.045)}
\]  
\[
x_2 = \frac{-3047.048}{-333.413}
\]  
\[
x_2 = 0.913
\]  

The internal energy \( u_1 \) in state 1 is calculated as:  
\[
u_1 = u_{1f} + x_1 \left( u_{1g} - u_{1f} \right)
\]  
Substituting values:  
\[
u_1 = -0.045 + 0.6 \left( -333.458 - (-0.045) \right)
\]  
\[
u_1 = -0.045 + 0.6 \cdot (-333.413)
\]  
\[
u_1 = -200.093
\]  

The heat transferred \( Q_{12} \) is used to calculate \( u_2 \):  
\[
u_2 = \frac{Q_{12}}{m_{\text{EW}}} + u_1
\]  
Substituting values:  
\[
u_2 = \frac{-2847}{0.1} + (-200.093)
\]  
\[
u_2 = -3047.093 \, \text{kJ/kg}
\]