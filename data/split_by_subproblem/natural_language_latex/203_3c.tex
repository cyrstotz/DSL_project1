1. Heat balance on the gas container:

The change in energy, Delta E, equals Q minus W, which equals the change in internal energy, Delta U.

Q equals W plus U2 minus U1, which equals W plus m times c_v times (T2 minus T1).

This equals p1 times (V2 minus V1) plus m times c_v times (T2 minus T1).