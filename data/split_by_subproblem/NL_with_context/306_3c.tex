First law of thermodynamics (closed system):  
E2 minus E1 equals Q12 minus Wv,rev.  
Wv,rev equals the integral from state 1 to state 2 of p dv.  
m g (u2 minus u1) equals Q12.  
m g c v (T2 minus T1) equals Q12.  

---