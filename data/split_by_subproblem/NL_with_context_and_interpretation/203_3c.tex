First law applied to the gas container:  
\( \Delta E = Q - W = \Delta U \)  

\( Q = W + U_2 - U_1 = W + m_g c_V (T_2 - T_1) \)  

\( = p_1 (V_2 - V_1) + m_g c_V (T_2 - T_1) \)